Процедура ПриЗаписи(Отказ)
    // Поиск существующего пользователя по логину
    Пользователь = ПользователиИнформационнойБазы.НайтиПоИмени(ЭтотОбъект.Код_Аптеки);

    Если Пользователь = Неопределено Тогда
        // Создание нового пользователя для сотрудника
        НовыйПользователь = ПользователиИнформационнойБазы.СоздатьПользователя();
        НовыйПользователь.Имя = ЭтотОбъект.Код_Аптеки;
        НовыйПользователь.ПолноеИмя = ЭтотОбъект.ФИО_фармацевт;
        НовыйПользователь.АутентификацияСтандартная = Истина;
        НовыйПользователь.Пароль = "";
        НовыйПользователь.Роли.Добавить(Метаданные.Роли.Фармацевт);
        НовыйПользователь.ПоказыватьВСпискеВыбора = Ложь;
        НовыйПользователь.Язык = Метаданные.Языки.Русский;
        НовыйПользователь.Записать();
        Сообщить("Создан новый пользователь для аптеки.");
    Иначе
        // Обновление ФИО существующего пользователя
        Пользователь.ПолноеИмя = ЭтотОбъект.ФИО_фармацевт;
        Пользователь.Записать();
        Сообщить("Обновлено ФИО существующего пользователя для аптеки.");
    КонецЕсли;
КонецПроцедуры
